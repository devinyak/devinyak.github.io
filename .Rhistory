plot(income)
mean(income)
income=0
for (i in 2:201){
set.seed(14*i)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>5])*as.numeric(data$outcome[test][data$bet1[test]>5]=="win1"))-sum(data$bet1[test]>5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>5])*as.numeric(data$outcome[test][data$bet2[test]>5]=="win2"))-sum(data$bet2[test]>5)
}
#----------------
plot(income)
mean(income)
income=0
for (i in 2:201){
set.seed(15*i)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>5])*as.numeric(data$outcome[test][data$bet1[test]>5]=="win1"))-sum(data$bet1[test]>5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>5])*as.numeric(data$outcome[test][data$bet2[test]>5]=="win2"))-sum(data$bet2[test]>5)
}
#----------------
plot(income)
mean(income)
income=0
for (i in 2:201){
set.seed(16*i)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>5])*as.numeric(data$outcome[test][data$bet1[test]>5]=="win1"))-sum(data$bet1[test]>5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>5])*as.numeric(data$outcome[test][data$bet2[test]>5]=="win2"))-sum(data$bet2[test]>5)
}
#----------------
plot(income)
mean(income)
income=0
for (i in 2:201){
set.seed(17*i)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>5])*as.numeric(data$outcome[test][data$bet1[test]>5]=="win1"))-sum(data$bet1[test]>5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>5])*as.numeric(data$outcome[test][data$bet2[test]>5]=="win2"))-sum(data$bet2[test]>5)
}
#----------------
plot(income)
mean(income)
income=0
for (i in 2:201){
set.seed(18*i)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>5])*as.numeric(data$outcome[test][data$bet1[test]>5]=="win1"))-sum(data$bet1[test]>5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>5])*as.numeric(data$outcome[test][data$bet2[test]>5]=="win2"))-sum(data$bet2[test]>5)
}
#----------------
plot(income)
mean(income)
income=0
for (i in 2:201){
set.seed(19*i)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>5])*as.numeric(data$outcome[test][data$bet1[test]>5]=="win1"))-sum(data$bet1[test]>5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>5])*as.numeric(data$outcome[test][data$bet2[test]>5]=="win2"))-sum(data$bet2[test]>5)
}
#----------------
plot(income)
mean(income)
income=0
for (i in 2:201){
set.seed(20*i)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>5])*as.numeric(data$outcome[test][data$bet1[test]>5]=="win1"))-sum(data$bet1[test]>5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>5])*as.numeric(data$outcome[test][data$bet2[test]>5]=="win2"))-sum(data$bet2[test]>5)
}
#----------------
plot(income)
mean(income)
income=0
for (i in 2:201){
set.seed(21*i)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>5])*as.numeric(data$outcome[test][data$bet1[test]>5]=="win1"))-sum(data$bet1[test]>5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>5])*as.numeric(data$outcome[test][data$bet2[test]>5]=="win2"))-sum(data$bet2[test]>5)
}
#----------------
plot(income)
mean(income)
income=0
for (i in 2:201){
set.seed(22*i)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>5])*as.numeric(data$outcome[test][data$bet1[test]>5]=="win1"))-sum(data$bet1[test]>5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>5])*as.numeric(data$outcome[test][data$bet2[test]>5]=="win2"))-sum(data$bet2[test]>5)
}
#----------------
plot(income)
mean(income)
income=0
for (i in 2:31){
set.seed(22*i)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>5])*as.numeric(data$outcome[test][data$bet1[test]>5]=="win1"))-sum(data$bet1[test]>5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>5])*as.numeric(data$outcome[test][data$bet2[test]>5]=="win2"))-sum(data$bet2[test]>5)
}
plot(income)
mean(income)
tail()income)
tail(income)
min(income)
tail(income,1)
end=0
prosadka=0
for (j in 1:100){
income=0
for (i in 2:31){
set.seed(j*i-17)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>5])*as.numeric(data$outcome[test][data$bet1[test]>5]=="win1"))-sum(data$bet1[test]>5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>5])*as.numeric(data$outcome[test][data$bet2[test]>5]=="win2"))-sum(data$bet2[test]>5)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
hist(end)
tail(sort(end))
tail(sort(end,"desc"))
tail(sort(end,T))
median()end)
median(end)
hist()prosadka)
hist(prosadka)
median(prosadka)
end=0
prosadka=0
for (j in 1:100){
income=0
for (i in 2:101){
set.seed(j*i-17)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>5])*as.numeric(data$outcome[test][data$bet1[test]>5]=="win1"))-sum(data$bet1[test]>5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>5])*as.numeric(data$outcome[test][data$bet2[test]>5]=="win2"))-sum(data$bet2[test]>5)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
tail(sort(end,T))
median(end)
hist(prosadka)
end=0
prosadka=0
for (j in 1:100){
income=0
for (i in 2:201){
set.seed(j*i-17)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>5])*as.numeric(data$outcome[test][data$bet1[test]>5]=="win1"))-sum(data$bet1[test]>5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>5])*as.numeric(data$outcome[test][data$bet2[test]>5]=="win2"))-sum(data$bet2[test]>5)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
tail(sort(end,T))
median()end)
median(en)
median(en)d
median(end)
hist(prosadka)
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-17)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>5])*as.numeric(data$outcome[test][data$bet1[test]>5]=="win1"))-sum(data$bet1[test]>5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>5])*as.numeric(data$outcome[test][data$bet2[test]>5]=="win2"))-sum(data$bet2[test]>5)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
tail(sort(end,T))
median(end)
hist(prosadka)
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-17)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>4])*as.numeric(data$outcome[test][data$bet1[test]>4]=="win1"))-sum(data$bet1[test]>4)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>4])*as.numeric(data$outcome[test][data$bet2[test]>4]=="win2"))-sum(data$bet2[test]>4)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
tail(sort(end,T))
median(end)
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-17)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>5.5])*as.numeric(data$outcome[test][data$bet1[test]>5.5]=="win1"))-sum(data$bet1[test]>5.5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>5.5])*as.numeric(data$outcome[test][data$bet2[test]>5.5]=="win2"))-sum(data$bet2[test]>5.5)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
tail(sort(end,T))
median(end)
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-17)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>6])*as.numeric(data$outcome[test][data$bet1[test]>6]=="win1"))-sum(data$bet1[test]>6)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>6])*as.numeric(data$outcome[test][data$bet2[test]>6]=="win2"))-sum(data$bet2[test]>6)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
tail(sort(end,T))
median(end)
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-17)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>6.5])*as.numeric(data$outcome[test][data$bet1[test]>6.5]=="win1"))-sum(data$bet1[test]>6.5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>6.5])*as.numeric(data$outcome[test][data$bet2[test]>6.5]=="win2"))-sum(data$bet2[test]>6.5)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
tail(sort(end,T))
median(end)
hist()prosadka)
hist(prosadka)
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-17)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>7])*as.numeric(data$outcome[test][data$bet1[test]>7]=="win1"))-sum(data$bet1[test]>7)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>7])*as.numeric(data$outcome[test][data$bet2[test]>7]=="win2"))-sum(data$bet2[test]>7)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
tail(sort(end,T))
median(end)
hist(prosadka)
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-17)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>7.5])*as.numeric(data$outcome[test][data$bet1[test]>7.5]=="win1"))-sum(data$bet1[test]>7.5)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>7.5])*as.numeric(data$outcome[test][data$bet2[test]>7.5]=="win2"))-sum(data$bet2[test]>7.5)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
tail(sort(end,T))
median(end)
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-17)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>8])*as.numeric(data$outcome[test][data$bet1[test]>8]=="win1"))-sum(data$bet1[test]>8)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>8])*as.numeric(data$outcome[test][data$bet2[test]>8]=="win2"))-sum(data$bet2[test]>8)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
tail(sort(end,T))
median(end)
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-13)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>8])*as.numeric(data$outcome[test][data$bet1[test]>8]=="win1"))-sum(data$bet1[test]>8)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>8])*as.numeric(data$outcome[test][data$bet2[test]>8]=="win2"))-sum(data$bet2[test]>8)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
median(end)
hist(prosadka)
upper=6
lower=7.5
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-13)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>lower & data$bet1[test]<upper])*as.numeric(data$outcome[test][data$bet1[test]>lower & data$bet1[test]<upper]=="win1"))-sum([data$bet1[test]>lower & data$bet1[test]<upper])
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>lower & data$bet2[test]<upper])*as.numeric(data$outcome[test][data$bet2[test]>lower & data$bet2[test]<upper]=="win2"))-sum([data$bet2[test]>lower & data$bet2[test]<upper])
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-13)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>lower & data$bet1[test]<upper])*as.numeric(data$outcome[test][data$bet1[test]>lower & data$bet1[test]<upper]=="win1"))-sum(data$bet1[test]>lower & data$bet1[test]<upper)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>lower & data$bet2[test]<upper])*as.numeric(data$outcome[test][data$bet2[test]>lower & data$bet2[test]<upper]=="win2"))-sum(data$bet2[test]>lower & data$bet2[test]<upper)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
tail(sort(end,T))
median(end)
hist(prosadka)
lower=6
upper=7.5
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-13)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>lower & data$bet1[test]<upper])*as.numeric(data$outcome[test][data$bet1[test]>lower & data$bet1[test]<upper]=="win1"))-sum(data$bet1[test]>lower & data$bet1[test]<upper)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>lower & data$bet2[test]<upper])*as.numeric(data$outcome[test][data$bet2[test]>lower & data$bet2[test]<upper]=="win2"))-sum(data$bet2[test]>lower & data$bet2[test]<upper)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
median(end)
hist(prosadka)
data=read.csv("~/bookmaker/ОЛЕГ.csv",header=F)
names(data)=c("date","team1","team2","goals1","goals2","bet1","bet2")
data$outcome=rep(0,nrow(data))
data$outcome[data$goals1>data$goals2]="win1"
data$outcome[data$goals1==data$goals2]="draw"
data$outcome[data$goals1<data$goals2]="win2"
data$outcome=as.factor(data$outcome)
levels(data$outcome)=c("win1","draw","win2")
lower=6
upper=8
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-13)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>lower & data$bet1[test]<upper])*as.numeric(data$outcome[test][data$bet1[test]>lower & data$bet1[test]<upper]=="win1"))-sum(data$bet1[test]>lower & data$bet1[test]<upper)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>lower & data$bet2[test]<upper])*as.numeric(data$outcome[test][data$bet2[test]>lower & data$bet2[test]<upper]=="win2"))-sum(data$bet2[test]>lower & data$bet2[test]<upper)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
median(end)
hist(prosadka)
lower=6
upper=20
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-13)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>lower & data$bet1[test]<upper])*as.numeric(data$outcome[test][data$bet1[test]>lower & data$bet1[test]<upper]=="win1"))-sum(data$bet1[test]>lower & data$bet1[test]<upper)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>lower & data$bet2[test]<upper])*as.numeric(data$outcome[test][data$bet2[test]>lower & data$bet2[test]<upper]=="win2"))-sum(data$bet2[test]>lower & data$bet2[test]<upper)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
tail(sort(end,T))
median(end)
hist(prosadka)
data$bet2[test]>lower & data$bet2[test]<upper
data$outcome[test][data$bet1[test]>lower & data$bet1[test]<upper]=="win1"
data$outcome[test][data$bet1[test]>lower & data$bet1[test]<upper]=="win1"
test
data$outcome[test][data$bet1[test]>lower & data$bet1[test]<upper]
data$bet1[test]>lower & data$bet1[test]<upper
data$outcome[test]
data$outcome[test][data$bet2[test]>lower & data$bet2[test]<upper]
data$bet2[test]>lower & data$bet2[test]<upper
sum(data$bet1[test]>lower & data$bet1[test]<upper)
plot(income)
lower=6
upper=20
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-13)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][data$bet1[test]>lower & data$bet1[test]<upper])*as.numeric(data$outcome[test][data$bet1[test]>lower & data$bet1[test]<upper]=="win1"))-sum(data$bet1[test]>lower & data$bet1[test]<upper)
income[i]=income[i]+sum((data$bet2[test][data$bet2[test]>lower & data$bet2[test]<upper])*as.numeric(data$outcome[test][data$bet2[test]>lower & data$bet2[test]<upper]=="win2"))-sum(data$bet2[test]>lower & data$bet2[test]<upper)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
median(end)
hist(prosadka)
hist()end)
hist(end)
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-13)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][(data$bet1[test]>lower)])*as.numeric(data$outcome[test][data$bet1[test]>lower]=="win1"))-sum(data$bet1[test]>lower)
income[i]=income[i]+sum((data$bet2[test][(data$bet2[test]>lower)])*as.numeric(data$outcome[test][data$bet2[test]>lower]=="win2"))-sum(data$bet2[test]>lower)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
median(end)
hist(prosadka)
end=0
prosadka=0
for (j in 1:200){
income=0
for (i in 2:301){
set.seed(j*i-17)
sampl=sample(nrow(data))
train=sample(nrow(data))[1:round(0.95*nrow(data))]
test=setdiff(sampl,train)
income[i]=income[i-1]+sum((data$bet1[test][(data$bet1[test]>lower)])*as.numeric(data$outcome[test][data$bet1[test]>lower]=="win1"))-sum(data$bet1[test]>lower)
income[i]=income[i]+sum((data$bet2[test][(data$bet2[test]>lower)])*as.numeric(data$outcome[test][data$bet2[test]>lower]=="win2"))-sum(data$bet2[test]>lower)
}
end[j]=tail(income,1)
prosadka[j]=min(income)
}
median(end)
hist(prosadka)


<!DOCTYPE html> 
<!--
	Noam's theme, based on Readnik scriptogr.am theme
-->
<html lang="en">
<head>
  <title>stat.org.ua | Критерій хі-квадрат *на пальцях*</title>
  <meta name="description" content=" " />
  <meta name="author" content="Олег Девіняк">
  <meta name="viewport" content="width=device-width; initial-scale=1.0; maximum-scale=1.0;">
  <meta name="apple-mobile-web-app-capable" content="yes"/>
  <meta name="ROBOTS" content="INDEX,FOLLOW">
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
  <meta charset="utf-8">
  <meta property="og:url" content="">
  <meta property="og:site_name" content="Олег Девіняк">
  <link rel="icon" type="image/x-icon" href="/assets/themes/noamblog/atom.ico">
  <link href="/assets/themes/noamblog/css/style.css" rel="stylesheet" type="text/css" media="all">
  <link href="http://raw.githubusercontent.com/mojombo/tpw/master/css/syntax.css" rel="stylesheet" type="text/css" media="all">
  


  <script type="text/javascript">
  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-21543661-5']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();
</script>



 <script type="text/javascript"> 
    function typeset() {
      MathJax.Hub.Queue(["Typeset",MathJax.Hub]);
    }
    function disqus_config() {
      this.callbacks.onNewComment = [typeset];
      this.callbacks.onInit = [typeset];
    }
  </script>
  <script src="http://cachedcommons.org/javascripts/text/prettify-min.js" type="text/javascript"></script>
  <script src="http://cachedcommons.org/javascripts/text/showdown-min.js" type="text/javascript"></script>
  <script src="http://cachedcommons.org/javascripts/jquery/jquery.disqus.js" type="text/javascript"></script>
  <script type="text/javascript" src="/assets/themes/noamblog/app.js"></script>  
  <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"> </script>
  <script type="text/x-mathjax-config">  MathJax.Hub.Config({ "HTML-CSS": { availableFonts: ["TeX"], webfont: [null] }} ); </script>
  <script type="text/x-mathjax-config">  MathJax.Hub.Config({ TeX: { extensions: ["autobold.js"] }} ); </script>
  <script type="text/javascript">var switchTo5x=true;</script>

  <script type="text/javascript">
      function showhide(id) {
           var e = document.getElementById(id);
           if(e.style.display == 'block')
              e.style.display = 'none';
           else
              e.style.display = 'block';
        }
  </script>
  <link rel="stylesheet" href="/crimson/stylestylesheet.css" type="text/css" charset="utf-8" />
  
</head>
<body>
<div class="wrapper">
  <div class="blog">

      <div id="menu" class="menu-top">
        <div class="blog-info">
          <h1><a href="/index.html">Олег Девіняк</a></h1>
          <div class="blog-description">
           <h2>Статистична допомога - 99999</h2>
          </div>
         </div>
          <div class="pages">
            


<!-- Put this div tag to the place, where the Like block will be -->

            
        
             
             
            


  
    
  
    
  
    
    	
    	<a href="/3-publications.html">Публікації</a>
    	
    
  
    
  
    
    	
    	<a href="/tags.html">Категорії</a>
    	
    
  
    
  
    
    	
    	<a href="/2-about.html">Про автора</a>
    	
    
  
    
    	
    	<a href="/donewrong/index.html">Статистика наперекосяк</a>
    	
    
  
    
    	
    	<a href="/blog/index.html">Статті</a>
    	
    
  
    
    	
    	<a href="/statclasses/index.html">Статистика з R</a>
    	
    
  
    
  
    
    	
    	<a href="/1-connect.html">Контакти</a>
    	
    
  
    
  



            
        </div>
      </div>

      <div class="container">

        <div class="content">
          
<div id="headblock">
<h1 id="page.title"><a href="/blog/blog/chisquared-simple/">Критерій хі-квадрат *на пальцях*</a></h1>
<p>by <em>Девіняк Олег</em>, 28 April 2014</p>
<hr />
</div>
<div class="contenttext"><p><p>Статистика – наука про випадковість, і вона нічого не знає про якісь зв&#39;язки, закономірності чи залежності. Зате вона знає все про випадковість. Роблячи статистичні тести, ми насправді перевіряємо статистичні гіпотези. Ту гіпотезу, яку перевіряє статистика, називають нульовою. Протилежна гіпотеза до нульової називається альтернативною. Нульова гіпотеза завжди каже, що будь-які відмінності – випадкові. Альтернативна тоді каже, що відмінності не випадкові, тобто між досліджуваними ознаками є причинно-наслідковий (або якийсь інший) зв&#39;язок. Критерій хі-квадрат часто використовується у науковій літературі і дозволяє дослідити відмінності у частотах різних ознак. Розглянемо його обчислення на прикладі.</p>

<p>В якості прикладу, розглянемо реальний випадок дослідження зв&#39;язку між формою власності аптеки і населеним пунктом [1]. Досліджуване питання звучить так: чи розподіл аптек за формою власності відрізняється у м. Львові від інших населених пунктів. Картина наступна:</p>

<p>| | Приватна | Державна чи комунальна | <strong>Сума</strong> |
  | Інші нас пункти | 188 | 10 | <strong>198</strong> |
  | Львів | 232 | 24 | <strong>256</strong> |
  | <strong>Сума</strong> | <strong>420</strong> | <strong>34</strong> |</p>

<p>Така таблиця називається <em>таблицею спряженості</em>. Ми досліджуємо дві змінні (чи два фактори, це також прийнятна назва). Перша – &quot;Форма власності&quot;, може приймати 2 варіанти (приватна і держ-комунальна). Друга – нас. пункт – також 2 варіанти (які - зрозуміло). Так як між варіантами не можна поставити відношення порядковості (більше-менше), не можна їх віднімати чи множити – то обидві змінні – номінальні (по-другому ще кажуть категорійні). Нульова гіпотеза: розподіл за власністю <strong>не залежить</strong> від того де знаходиться аптека. Альтернативна гіпотеза: розподіл за власністю <strong>залежить</strong> від того де знаходиться аптека. По таблиця спряженості видно, що у Львові частка держкомунальних аптек більша: 24/258=9,3%, тоді як в інших 10/198=5,05%. Але чи достатньо такої відмінності, щоб казати, що це невипадково, і влада міста Львів краще турбується про свої аптеки ніж влада інших нас. пунктів? Сконструюємо таку таблицю спряженості, для якої нульова гіпотеза буде справджуватись - у якої кількість Львівських аптек і кількість з інших пунктів була б така сама (256 і 198), але частка держкомунальних аптек була б однакова (щоб не було відмінності). Для цього знайдемо загальну (маргінальну) частку держ-комунальних аптек незалежно від місця: всі 34 аптеки / (420+34)= 7,489%. Тобто якби розподіл був рівномірний, то 7,489% аптек будь-якого населеного пункту були держкомунальні. Так як зі Львова було 256 аптек, то держкомунальних там мало бути 256<em>0.07489=19.17, а в інших населених пунктах – 198</em>0.07489=14.83. Тоді приватних у Львові 256-19.17=236.83, а в інших пунктах 198-14.83=183.17. Запишемо нову таблицю спряженості (ідеально випадкову - для якої нульова гіпотеза правдива):
| Приватна | Державна чи комунальна | Сума |
| Інші нас пункти | 183.17 | 14.83 | 198 |
| Львів | 236.83 | 19.17 | 258 |
| Сума  | 420 | 34 |</p>

<p>Бачимо – всі суми збігаються, але розподіл держ-комунальних тепер рівномірний (займає однаковий відсоток як від Львівських аптек, так і від інших нас. пунктів). 
Тепер обчислимо критерій хі-квадрат по формулі:
\[ \chi^2=\sum<em>{i=1}^{N}\frac{(O</em>{i}-E<em>{i})^2}{E</em>{i}}\],</p>

<p>де <em>О</em> позначає спостережувані кількості (<em>observed</em>), а <em>E</em> – очікувані (ті що в новій таблиці спряженості, <em>expected</em>). 
\[\frac{(188-183,17)^2}{183,17}+\frac{(10-14,83)^2}{14,83}+\frac{(232-236,83)^2}{236,83}+\frac{(24-19,17)^2}{19,17} = 0,127+1,573+0,098+1,22=3,018\\]. Оці 3,018 – показник наскільки сильні відмінності є у спостережуваній нами таблиці спряженості (тій що оригінальна порівняно з ідеально випадковою). Зрозуміло, що навіть у випадкових випадках можна спостерігати відмінності: наприклад нічого дивного, якщо монета впаде 2 чи 3 рази орлом догори – це не значить, що вона &quot;бракована&quot;. Зате при випадковості розподіл показника хі-квадрат достеменно відомий - ось він:</p>

<p><img src="%7B%7BBASE_URL%7D%7D/figures/chisq-distr.png" alt="графік"></p>

<p>Площа хвостика, який відсікається отриманим значенням 3,018 і буде нашою p-величиною.
В описаному випадку р=0,0823. Це означає, що таке велике число як 3, або ж і більше, можна отримати і повністю випадково з ймовірністю 8,23%. Це, в свою чергу, означає, що ми не можемо відкинути (заперечити) нульову гіпотезу – та диспропорція що ми бачили в таблиці досить спокійно може статись випадково. Але і стверджувати, що ніякого впливу чи зв&#39;язку не існує все одно не можна. Може і є залежність між формою власності і місцевістю, але вона дуже-дуже слабка. Тому р&gt;0,05 треба розуміти як &quot;в даному дослідженні не вдалось довести зв&#39;язок між формою власності і місцевістю&quot;.</p>

<p>Насправді, не все настільки елементарно. Тут навіть у найпростішому тесті хі-квадрат доводиться спрощувати, тому що до критерію хі-квадрат рекомендується застосовувати ще поправку Йетса на неперервність, та й для кожного розміру таблиць своя крива розподілу хі-квадрат. Але сам принцип: рахуємо якийсь показник (його, власне і називають критерієм), розподіл якого в умовах випадковості науці точно відомо. Дивимось, яка площа під відповідною кривою знаходиться після того знайденого показника – то і буде р-величина. р-величина – це ймовірність досягти таких же (і більших) відмінностей, але чисто випадково. Тому нам важливо, щоб р-величина була чим по менша. </p>

<p>На заключення, код на <code>R</code> для побудови малюнка
{% highlight S %}
x=seq(0.03,5,0.01) #послідовність чисел від 0.03 до 5 із кроком 0.01
plot(x,dchisq(x, df=1),type=&quot;l&quot;,col=&#39;blue&#39;) #графік, по осі абсцис - густина ймовірності
p.value=3.018
cord.x=c(p.value,seq(p.value,5,0.01),p.value) 
cord.y=c(0,dchisq(seq(p.value,5,0.01),1),0) 
polygon(cord.x,cord.y,col=&quot;red&quot;) #забарвлюєм область після р-величини
{% endhighlight %}</p>

<p>[1] Борецька О.Б. Організаційно-методичні засади створення та діяльності клініко-фармацевтичної служби в аптечних закладах України : автореф. дис. на здобуття наук. ступеня канд. фармац. наук : [спец.] 15.00.01 “Технологія ліків, організація фармацевтичної справи та судова фармація” / О. Б. Борецька ; Львів. нац. мед. ун-т ім. Данила Галицького. – Львів, 2013. – 24 с.</p>
</p></div>
<ul class="tags">
  
    <li><strong>Ключові слова: </strong></li>
    
    <li><a href="/tags.html#хі-квадрат-ref">хі-квадрат</a></li>
    
    <li><a href="/tags.html#R-ref">R</a></li>
    
    <li><a href="/tags.html#на-пальцях-ref">на-пальцях</a></li>
    
    <li><a href="/tags.html#основи-статистики-ref">основи-статистики</a></li>
    
    <li><a href="/tags.html#р-величина-ref">р-величина</a></li>
      
</ul>



  <div id="disqus_thread"></div>
<script type="text/javascript">
    var disqus_shortname = 'devinyak'; // required: replace example with your forum shortname
    var disqus_identifier = '/blog/blog/chisquared-simple/';
    var disqus_url = 'http://stat.org.ua/blog/blog/chisquared-simple/';
    
    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>





<div class="noprint" id="previous-posts"><hr />
<p> <strong>Попередня стаття</strong>: <a href="/blog/donewrong/intro/">Вступ</a> </p>
<p></p></div>



        </div>
    

      </div>
      
<script type="text/javascript" src="http://ajax.googleapis.com/ajax/libs/jquery/1.6.1/jquery.min.js"></script>
<script type="text/javascript" src="/assets/themes/noamblog/footnote-links.js"></script>
<script type="text/javascript">$('div.contenttext').footnoteLinks();</script>
</body>
</html>

